# Figure 2 参数验证报告

## 单位统一说明

**所有时间常数已统一为毫秒(ms)**，包括：
- τ (神经电流时间常数)
- τ_d (突触抑制时间常数) 
- τ_f (突触促进时间常数)
- dt (积分时间步长)

这样在代码中所有动力学方程都使用相同的时间单位，避免单位转换错误。

---

## 验收清单对照检查

### E. 参数表 (Table 1 对照)

#### #15 STD-dominated 参数 (Fig.2A-C)
| 参数 | Table 1 值 | 代码值 (ms) | 状态 |
|------|-----------|-------------|------|
| J0 | 0.13 | 0.13 | ✅ |
| a | 0.5 rad | 0.5 | ✅ |
| k | 0.0018 | 0.0018 | ✅ |
| τ | 0.01s | 10.0 ms | ✅ |
| τ_d | 3.0s | 3000.0 ms | ✅ |
| τ_f | 0.3s | 300.0 ms | ✅ |
| U | 0.5 | 0.5 | ✅ |

#### #16 STF-dominated 参数 (Fig.2D-F)
| 参数 | Table 1 值 | 代码值 (ms) | 状态 |
|------|-----------|-------------|------|
| J0 | 0.09 | 0.09 | ✅ |
| a | 0.15 rad | 0.15 | ✅ |
| k | 0.0095 | 0.0095 | ✅ |
| τ | 0.01s | 10.0 ms | ✅ |
| τ_d | 0.3s | 300.0 ms | ✅ |
| τ_f | 5.0s | 5000.0 ms | ✅ |
| U | 0.2 | 0.2 | ✅ |

### C. 外部输入参数 (Table 1)

#### #11 刺激/Cue 参数
| 参数 | Table 1 值 | 代码值 | 状态 |
|------|-----------|--------|------|
| α_sti | 20.0 | 20.0 | ✅ |
| a_sti | 0.3 rad | 0.3 | ✅ |
| α_cue | 2.5 | 2.5 | ✅ |
| a_cue | 0.4 rad | 0.4 | ✅ |

### D. 任务时间轴

#### #12 Trial Timeline
| 阶段 | 论文值 | 代码值 (ms) | 状态 |
|------|--------|-------------|------|
| S1 | 200ms | 200.0 | ✅ |
| ISI | 1000ms | 1000.0 | ✅ |
| S2 | 200ms | 200.0 | ✅ |
| Delay | 3400ms | 3400.0 | ✅ |
| Cue | 500ms | 500.0 | ✅ |

### B. 网络方程

#### #8 神经元与特征空间
| 参数 | 论文值 | 代码值 | 状态 |
|------|--------|--------|------|
| N | 100 | 100 | ✅ |
| θ 范围 | (-90°, 90°) | [-90°, 88.2°) | ✅ |
| dt | - | 0.1 ms | ✅ |

---

## 动力学方程单位分析

### 神经电流动力学
```
τ · du/dt = -u + ρ·J*r + I_ext
```
- τ = 10 ms
- dt = 0.1 ms
- 积分: u_new = u + du * dt / τ = u + du * 0.1/10 = u + du * 0.01

### STP 动力学
```
τ_d · dx/dt = (1-x) - τ_d · u·x·r
τ_f · du/dt = (U-u) + τ_f · U·(1-u)·r
```
- STD: τ_d = 3000 ms, τ_f = 300 ms
- STF: τ_d = 300 ms, τ_f = 5000 ms
- 积分: x_new = x + dx * dt = x + [(1-x)/τ_d - u·x·r] * 0.1

**单位验证：**
- dx 的单位: 1/ms (因为 τ_d 是 ms)
- dx * dt = (1/ms) * ms = 无量纲 ✅

---

## 测试结果汇总

- **测试文件**: `tests/test_fig2_checklist.py`
- **测试数量**: 26 个

### 测试类别
- A. 作用域与运行设置: 2 tests
- B. 网络方程与变量: 3 tests
- C. 外部输入与噪声: 3 tests
- D. 任务时间轴: 2 tests
- E. 参数表: 3 tests
- F. 刺激抽样与误差定义: 2 tests
- G. 解码与统计: 2 tests
- H. 结果验证: 3 tests
- I. DoG 拟合: 2 tests
- Smoke Tests: 4 tests

---

## 修改历史

### 2026-01-06: 单位统一化
**问题**: 原代码中时间常数单位不一致：
- τ, dt 使用毫秒
- τ_d, τ_f 使用秒
- STP 方程需要 `dt_sec = dt/1000` 转换

**解决**: 统一所有时间常数为毫秒
- τ_d: 3s → 3000ms (STD), 0.3s → 300ms (STF)
- τ_f: 0.3s → 300ms (STD), 5s → 5000ms (STF)
- STP 方程直接使用 dt，无需转换

---

*报告更新时间: 2026-01-06*
